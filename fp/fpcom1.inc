C     $Id$
C
      PARAMETER (NRM=20,NTHM=50,NPM=50,NTG1M=21,NTG2M=501)
      PARAMETER (NCRM=5)
      PARAMETER (NAVM=100)
      PARAMETER (NRMP=NRM+1,NTHMP=NTHM+1,NPMP=NPM+1)
      PARAMETER (NLM=13,NMM=NRM*NTHM*NPM,NMM2=128)
      PARAMETER (NWRM=50,NWTHM=33)
      REAL*8 COSM,COSG
C
      COMMON /FPPRM1/ ZEFF,NSFP
      COMMON /FPPRM3/ DRR0,E0,R1,DELR1,RMIN,RMAX
      COMMON /FPPRM4/ DEC,PEC1,PEC2,RFEC,DELYEC
      COMMON /FPPRM5/ DLH,PLH1,PLH2,RLH
      COMMON /FPPRM6/ DFW,PFW1,PFW2,RFW
      COMMON /FPPRM7/ PMAX,RIMPL,EPSM,EPSE,EPSDE,H0DE,LMAXE
      COMMON /FPPRM8/ NPMAX,NTHMAX,NRMAX,NAVMAX,NGLINE
      COMMON /FPPRM9/ DELT,NTMAX,NTSTP1,NTSTP2,NTSTPC
      COMMON /FPPRM0/ MODELE,MODELA,MODELC,MODELW,MODELR,LLMAX
      COMMON /FPWAV1/ RFDW,DELNPR,NCMIN,NCMAX
      COMMON /FPWAV2/ CEWR,CEWTH,CEWPH,RKWR,RKWTH,RKWPH,REWY,DREWY
      COMMON /FPWAV3/ EPSNWR,LMAXNWR
      COMMON /FPWAV4/ PWAVE,DELCRI,NTHWAV
C
      COMMON /FPFUN1/ F(NTHM,NPM,NRM),F1(NTHM,NPM,NRM)
C
      COMMON /FPVAR0/ ITL(NRM),ITU(NRM)
      COMMON /FPVAR1/ PG(NPMP),PM(NPM),DELP
      COMMON /FPVAR2/ THG(NTHMP),THM(NTHM),DELTH
      COMMON /FPVAR3/ RG(NRMP),RM(NRM),DELR
      COMMON /FPVAR4/ TIMEFP
      COMMON /FPVAR5/ RNFP0,RNFPS,RTFP0,RTFPS,AMFP,AEFP
      COMMON /FPVAR6/ PTFP0,VTFP0
C
      COMMON /FPPRF1/ RNFP(NRM),RTFP(NRM),PTFP(NRM),VTFP(NRM)
      COMMON /FPPRF2/ RNFD(NRM,NSM),RTFD(NRM,NSM)
      COMMON /FPPRF3/ PTFD(NRM,NSM),VTFD(NRM,NSM)
      COMMON /FPPRF4/ RNUF(NRM,NSM),RNUD(NRM,NSM)
      COMMON /FPPRF5/ BP(NRMP),QR(NRM)
      COMMON /FPPRF6/ RJ1(NRM),E1(NRM),RJ2(NRM),E2(NRM)
      COMMON /FPPRF7/ EPSR(NRM),THETA(NRM),DKBSR(NRM)
      COMMON /FPPRF8/ FS1(NTHM,NPM),FS2(NTHM,NPM)
C
      COMMON /FPCEF1/ VOL(NTHM,NPM)
      COMMON /FPCEF2/ ETAG(NTHMP,NRM),ETAM(NTHM,NRM),RLAMDA(NTHM,NRM)
      COMMON /FPCEF3/ SING(NTHMP),COSG(NTHMP),SINM(NTHM),COSM(NTHM)
      COMMON /FPCEF4/ WEIGHP(NTHM,NPMP,NRM),WEIGHT(NTHMP,NPM,NRM)
      COMMON /FPCEF5/ RLAMDC(NTHMP,NRM)
      COMMON /FPCEF6/ WEIGHR(NTHM,NPM,NRMP)
C
      COMMON /FPDFP1/ DPP(NTHM,NPMP,NRM),DPT(NTHM,NPMP,NRM),
     &                DTP(NTHMP,NPM,NRM),DTT(NTHMP,NPM,NRM),
     &                FPP(NTHM,NPMP,NRM),FTH(NTHMP,NPM,NRM),
     &                DRR(NTHM,NPM,NRMP),FRR(NTHM,NPM,NRMP),
     &                SP(NTHM,NPM,NRM)
      COMMON /FPDFP2/ FEPP(NTHM,NPMP,NRM),FETH(NTHMP,NPM,NRM)
      COMMON /FPDFP3/ DCPP(NTHM,NPMP,NRM),DCPT(NTHM,NPMP,NRM),
     &                DCTP(NTHMP,NPM,NRM),DCTT(NTHMP,NPM,NRM),
     &                FCPP(NTHM,NPMP,NRM),FCTH(NTHMP,NPM,NRM)
      COMMON /FPDFP4/ DWPP(NTHM,NPMP,NRM),DWPT(NTHM,NPMP,NRM),
     &                DWTP(NTHMP,NPM,NRM),DWTT(NTHMP,NPM,NRM)
      COMMON /FPDFP5/ DWLHPP(NTHM,NPMP,NRM),DWLHPT(NTHM,NPMP,NRM)
      COMMON /FPDFP6/ DWFWPP(NTHM,NPMP,NRM),DWFWPT(NTHM,NPMP,NRM)
      COMMON /FPDFP7/ DWECPP(NTHM,NPMP,NRM),DWECPT(NTHM,NPMP,NRM)
C
      COMMON /FPGRF1/ RTG(NTG1M),PTG(NTG2M),NTG1,NTG2,ISAVE
C
      COMMON /FPFNC1/ PX,NRX,NTHX
C
      COMMON /FPPUT1/ RNS(NRM),RJS(NRM),RWS(NRM),
     &                RPCS(NRM),RPWS(NRM),RPES(NRM),
     &                RLHS(NRM),RFWS(NRM),RECS(NRM)
      COMMON /FPPUT2/ RNT(NRM,NTG1M),RJT(NRM,NTG1M),RWT(NRM,NTG1M),
     &                RTT(NRM,NTG1M),RET(NRM,NTG1M),RQT(NRM,NTG1M),
     &                RPCT(NRM,NTG1M),RPWT(NRM,NTG1M),RPET(NRM,NTG1M),
     &                RLHT(NRM,NTG1M),RFWT(NRM,NTG1M),RECT(NRM,NTG1M)
      COMMON /FPPUT4/ PNT(NTG2M),PIT(NTG2M),PWT(NTG2M),
     &                PTT(NTG2M),PET(NTG2M),PQT(NTG2M),
     &                PPCT(NTG2M),PPWT(NTG2M),PPET(NTG2M),
     &                PLHT(NTG2M),PFWT(NTG2M),PECT(NTG2M)
C
      COMMON /FPMTX1/ AL(NMM,NLM),DL(NMM),LL(NMM,NLM),NMMAX,NLMAX
      COMMON /FPMTX2/ AM(NMM,NLM),DM(NMM),LM(NMM,NLM),BM(NMM)
      COMMON /FPMTX3/ FM(NMM+NMM2)
      COMMON /FPMTX4/ NMA(NTHM,NPM,NRM)
      COMMON /FPMTX5/ WK1(NMM+NMM2),WK2(NMM+NMM2,5)
C
      COMMON /FPWAV5/ CEWV(3,NWTHM,NWRM)
      COMMON /FPWAV6/ NWTHMAX,NWRMAX
      COMMON /FPWAV7/ CFFT(NWTHM),RFFT(NWTHM),LFFT(NWTHM)
      COMMON /FPWAV8/ RWSPL(NWRM),THWSPL(NWTHM),UCEW(4,4,NWTHM,NWRM,3)
      COMMON /FPWAV9/ RAW,RRW,BBW,RFWR,RFWI,NPH0W,NTH0W
C
      COMMON /FPDBG1/ IFLAG
