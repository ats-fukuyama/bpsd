C     $Id$
C
c      PARAMETER (NRM=4,NTHM=51,NPM=51,NTG1M=11,NTG2M=21)
      PARAMETER (NRM=51,NTHM=101,NPM=101,NTG1M=51,NTG2M=501)
      PARAMETER (NCRM=5)
      PARAMETER (NAVM=100)
      PARAMETER (NLM=13,NMM=NRM*NTHM*NPM,NMM2=128)
      PARAMETER (NWRM=200,NWTHM=65)
      PARAMETER (NSAM=3,NSBM=3)
      REAL*8 COSM,COSG
C
      COMMON /FPPRM1/ ZEFF,NSBEAM,NSFPMI,NSFPMA
      COMMON /FPPRM3/ DRR0,E0,R1,DELR1,RMIN,RMAX
      COMMON /FPPRM4/ DEC,PEC1,PEC2,RFEC,DELYEC
      COMMON /FPPRM5/ DLH,PLH1,PLH2,RLH
      COMMON /FPPRM6/ DFW,PFW1,PFW2,RFW
      COMMON /FPPRM7/ PMAX,RIMPL,EPSM,EPSE,EPSDE,H0DE,LMAXE
      COMMON /FPPRM8/ NPMAX,NTHMAX,NRMAX,NAVMAX,NGLINE,NGRAPH
      COMMON /FPPRM9/ DELT,NTMAX,NTSTP1,NTSTP2,NTSTPC
      COMMON /FPPRM0/ MODELE,MODELA,MODELC,MODELW,MODELR,LLMAX,IDBGFP
      COMMON /FPWAV1/ RFDW,DELNPR,NCMIN,NCMAX
      COMMON /FPWAV2/ CEWR,CEWTH,CEWPH,RKWR,RKWTH,RKWPH,REWY,DREWY
      COMMON /FPWAV3/ EPSNWR,LMAXNWR
      COMMON /FPWAV4/ PWAVE,DELCRI,NTHWAV
      COMMON /FPWAV5/ FACTWM
C
      COMMON /FPFUN1/ F(NTHM,NPM,NRM),F1(NTHM,NPM,NRM)
      COMMON /FPFUN2/ FNS(NTHM,NPM,NRM,NSAM),FNS1(NTHM,NPM,NRM,NSAM)
C
      COMMON /FPVAR0/ ITL(NRM),ITU(NRM)
      COMMON /FPVAR1/ PG(NPM),PM(NPM),DELP
      COMMON /FPVAR2/ THG(NTHM),THM(NTHM),DELTH
      COMMON /FPVAR3/ RG(NRM),RM(NRM),DELR
      COMMON /FPVAR4/ TIMEFP,NSAMAX,NSBMAX
      COMMON /FPVAR5/ NS_NSA(NSAM),NS_NSB(NSBM)
      COMMON /FPVAR6/ RNFP0(NSAM),RNFPS(NSAM),RTFP0(NSAM),RTFPS(NSAM)
      COMMON /FPVAR7/ PTFP0(NSAM),VTFP0(NSAM),PTFD0(NSBM),VTFD0(NSBM)
      COMMON /FPVAR8/ AMFP(NSAM),AEFP(NSAM)
      COMMON /FPVAR9/ AMFD(NSBM),AEFD(NSBM)
C
      COMMON /FPPRF1/ RNFP(NRM,NSAM),RTFP(NRM,NSAM)
      COMMON /FPPRF2/ PTFP(NRM,NSAM),VTFP(NRM,NSAM)
      COMMON /FPPRF3/ RNFD(NRM,NSBM),RTFD(NRM,NSBM)
      COMMON /FPPRF4/ PTFD(NRM,NSBM),VTFD(NRM,NSBM)
      COMMON /FPPRF5/ RNUF(NRM,NSBM,NSAM),RNUD(NRM,NSBM,NSAM)
      COMMON /FPPRF6/ BP(NRM),QR(NRM),EPSR(NRM)
      COMMON /FPPRF7/ RJ1(NRM),E1(NRM),RJ2(NRM),E2(NRM)
      COMMON /FPPRF8/ THETA0(NSAM),THETA(NRM,NSAM)
      COMMON /FPPRF9/ FS1(NTHM,NPM,NSAM),FS2(NTHM,NPM,NSAM)
C
      COMMON /FPCEF1/ VOL(NTHM,NPM)
      COMMON /FPCEF2/ ETAG(NTHM,NRM),ETAM(NTHM,NRM),RLAMDA(NTHM,NRM)
      COMMON /FPCEF3/ SING(NTHM),COSG(NTHM),SINM(NTHM),COSM(NTHM)
      COMMON /FPCEF4/ WEIGHP(NTHM,NPM,NRM,NSAM)
      COMMON /FPCEF5/ WEIGHT(NTHM,NPM,NRM,NSAM)
      COMMON /FPCEF6/ RLAMDC(NTHM,NRM)
      COMMON /FPCEF7/ WEIGHR(NTHM,NPM,NRM,NSAM)
C
      COMMON /FPDFP1/ DPP(NTHM,NPM,NRM,NSAM),DPT(NTHM,NPM,NRM,NSAM),
     &                DTP(NTHM,NPM,NRM,NSAM),DTT(NTHM,NPM,NRM,NSAM),
     &                FPP(NTHM,NPM,NRM,NSAM),FTH(NTHM,NPM,NRM,NSAM),
     &                DRR(NTHM,NPM,NRM,NSAM),FRR(NTHM,NPM,NRM,NSAM),
     &                SP(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP2/ FEPP(NTHM,NPM,NRM,NSAM),FETH(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP3/ DCPP(NTHM,NPM,NRM,NSAM),DCPT(NTHM,NPM,NRM,NSAM),
     &                DCTP(NTHM,NPM,NRM,NSAM),DCTT(NTHM,NPM,NRM,NSAM),
     &                FCPP(NTHM,NPM,NRM,NSAM),FCTH(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP4/ DWPP(NTHM,NPM,NRM,NSAM),DWPT(NTHM,NPM,NRM,NSAM),
     &                DWTP(NTHM,NPM,NRM,NSAM),DWTT(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP5/ DWLHPP(NTHM,NPM,NRM,NSAM),
     &	              DWLHPT(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP6/ DWFWPP(NTHM,NPM,NRM,NSAM),
     &	              DWFWPT(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP7/ DWECPP(NTHM,NPM,NRM,NSAM),
     &                DWECPT(NTHM,NPM,NRM,NSAM)
      COMMON /FPDFP8/ DCPP2(NTHM,NPM,NRM,NSBM,NSAM),
     &                DCPT2(NTHM,NPM,NRM,NSBM,NSAM),
     &		      DCTP2(NTHM,NPM,NRM,NSBM,NSAM),
     &                DCTT2(NTHM,NPM,NRM,NSBM,NSAM),
     &		      FCPP2(NTHM,NPM,NRM,NSBM,NSAM),
     &                FCTH2(NTHM,NPM,NRM,NSBM,NSAM)
C
      COMMON /FPGRF1/ RTG(NTG1M),PTG(NTG2M),NTG1,NTG2,ISAVE,NTG3
C
      COMMON /FPFNC1/ PX,NRX,NTHX
C
      COMMON /FPPUT1/ RNS(NRM,NSAM),RJS(NRM,NSAM),RWS(NRM,NSAM),
     &                RPCS(NRM,NSAM),RPWS(NRM,NSAM),RPES(NRM,NSAM),
     &                RLHS(NRM,NSAM),RFWS(NRM,NSAM),RECS(NRM,NSAM),
     &		      RWS123(NRM,NSAM)
      COMMON /FPPUT2/ RNT(NRM,NSAM,NTG1M),RJT(NRM,NSAM,NTG1M),
     &                RWT(NRM,NSAM,NTG1M),RTT(NRM,NSAM,NTG1M),
     &                RPCT(NRM,NSAM,NTG1M),RPWT(NRM,NSAM,NTG1M),
     &                RPET(NRM,NSAM,NTG1M),RLHT(NRM,NSAM,NTG1M),
     &                RFWT(NRM,NSAM,NTG1M),RECT(NRM,NSAM,NTG1M),
     &                RET(NRM,NTG1M),RQT(NRM,NTG1M)
      COMMON /FPPUT4/ PNT(NSAM,NTG2M),PIT(NSAM,NTG2M),
     &                PWT(NSAM,NTG2M),PTT(NSAM,NTG2M),
     &                PPCT(NSAM,NTG2M),PPWT(NSAM,NTG2M),
     &                PPET(NSAM,NTG2M),PLHT(NSAM,NTG2M),
     &                PFWT(NSAM,NTG2M),PECT(NSAM,NTG2M),
     &                PET(NTG2M),PQT(NTG2M),PWT2(NSAM,NTG2M),
     &		      PTT2(NSAM,NTG2M)
      COMMON /FPPUT5/ PPCT2(NSBM,NSAM,NTG2M)
      COMMON /FPPUT6/ RPCT2(NRM,NSBM,NSAM,NTG2M)
      COMMON /FPPUT7/ RPCS2(NRM,NSBM,NSAM)
C
      COMMON /FPMTX1/ AL(NMM,NLM),DL(NMM),LL(NMM,NLM),NMMAX,NLMAX
      COMMON /FPMTX2/ AM(NMM,NLM),DM(NMM),BM(NMM),LM(NMM,NLM)
      COMMON /FPMTX3/ FM(NMM+NMM2)
      COMMON /FPMTX4/ NMA(NTHM,NPM,NRM)
C
      COMMON /FPWAV5/ CEWV(3,NWTHM,NWRM)
      COMMON /FPWAV6/ NWTHMAX,NWRMAX
      COMMON /FPWAV7/ CFFT(NWTHM),RFFT(NWTHM),LFFT(NWTHM)
      COMMON /FPWAV8/ RWSPL(NWRM),THWSPL(NWTHM),UCEW(4,4,NWTHM,NWRM,3)
      COMMON /FPWAV9/ RAW,RRW,BBW,RFWR,RFWI,NPH0W,NTH0W
      COMMON /FPWV10/ RABSE
C
      COMMON /FPDBG1/ IFLAG


